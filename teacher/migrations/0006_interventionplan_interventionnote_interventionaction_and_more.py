# Generated by Django 5.2.5 on 2025-11-23 00:12

import django.core.validators
import django.db.models.deletion
import django.utils.timezone
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ("admin_functionalities", "0012_schoolyear"),
        ("enrollmentprocess", "0003_alter_sectionplacement_selected_program"),
        ("teacher", "0005_earlywarningalert_initial_grade"),
    ]

    operations = [
        migrations.CreateModel(
            name="InterventionPlan",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "quarter",
                    models.CharField(
                        choices=[
                            ("Q1", "Quarter 1"),
                            ("Q2", "Quarter 2"),
                            ("Q3", "Quarter 3"),
                            ("Q4", "Quarter 4"),
                        ],
                        max_length=2,
                        verbose_name="Quarter",
                    ),
                ),
                (
                    "risk_level",
                    models.CharField(
                        choices=[
                            ("At Risk", "At Risk"),
                            ("Critical", "Critical"),
                            ("Resolved", "Resolved"),
                        ],
                        default="At Risk",
                        max_length=20,
                        verbose_name="Risk Level",
                    ),
                ),
                (
                    "current_grade",
                    models.FloatField(
                        default=0,
                        validators=[
                            django.core.validators.MinValueValidator(0),
                            django.core.validators.MaxValueValidator(100),
                        ],
                        verbose_name="Current Grade",
                    ),
                ),
                (
                    "total_absences",
                    models.PositiveIntegerField(
                        default=0, verbose_name="Total Absences"
                    ),
                ),
                (
                    "missing_written_works",
                    models.PositiveIntegerField(
                        default=0, verbose_name="Missing Written Works"
                    ),
                ),
                (
                    "missing_performance_tasks",
                    models.PositiveIntegerField(
                        default=0, verbose_name="Missing Performance Tasks"
                    ),
                ),
                (
                    "missed_quarterly_assessment",
                    models.BooleanField(
                        default=False, verbose_name="Missed Quarterly Assessment"
                    ),
                ),
                (
                    "current_tier",
                    models.CharField(
                        choices=[
                            ("Tier 1", "Tier 1: Prevention"),
                            ("Tier 2", "Tier 2: Targeted Support"),
                            ("Tier 3", "Tier 3: Intensive Intervention"),
                        ],
                        default="Tier 1",
                        max_length=10,
                        verbose_name="Current Intervention Tier",
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(default=True, verbose_name="Is Active"),
                ),
                (
                    "is_resolved",
                    models.BooleanField(default=False, verbose_name="Is Resolved"),
                ),
                (
                    "resolved_date",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Resolved Date"
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="created_intervention_plans",
                        to="admin_functionalities.teacher",
                        verbose_name="Created By",
                    ),
                ),
                (
                    "school_year",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="intervention_plans",
                        to="admin_functionalities.schoolyear",
                        verbose_name="School Year",
                    ),
                ),
                (
                    "section",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="intervention_plans",
                        to="admin_functionalities.section",
                        verbose_name="Section",
                    ),
                ),
                (
                    "student",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="intervention_plans",
                        to="enrollmentprocess.student",
                        verbose_name="Student",
                    ),
                ),
                (
                    "subject",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="intervention_plans",
                        to="admin_functionalities.subject",
                        verbose_name="Subject",
                    ),
                ),
            ],
            options={
                "verbose_name": "Intervention Plan",
                "verbose_name_plural": "Intervention Plans",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="InterventionNote",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                ("note", models.TextField(verbose_name="Note")),
                (
                    "note_date",
                    models.DateField(
                        default=django.utils.timezone.now, verbose_name="Note Date"
                    ),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                (
                    "created_by",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="intervention_notes",
                        to="admin_functionalities.teacher",
                        verbose_name="Created By",
                    ),
                ),
                (
                    "intervention_plan",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="notes",
                        to="teacher.interventionplan",
                        verbose_name="Intervention Plan",
                    ),
                ),
            ],
            options={
                "verbose_name": "Intervention Note",
                "verbose_name_plural": "Intervention Notes",
                "ordering": ["-note_date", "-created_at"],
            },
        ),
        migrations.CreateModel(
            name="InterventionAction",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "tier",
                    models.CharField(
                        choices=[
                            ("Tier 1", "Tier 1: Prevention"),
                            ("Tier 2", "Tier 2: Targeted Support"),
                            ("Tier 3", "Tier 3: Intensive Intervention"),
                        ],
                        max_length=10,
                        verbose_name="Tier",
                    ),
                ),
                (
                    "action_type",
                    models.CharField(
                        choices=[
                            ("Student Conference", "Student Conference"),
                            ("Parent Contact", "Parent Contact"),
                            ("Tutoring Session", "Tutoring Session"),
                            ("Makeup Work", "Makeup Work Opportunity"),
                            ("Behavior Plan", "Behavior Plan"),
                            ("Counseling Referral", "Counseling Referral"),
                            ("Other", "Other"),
                        ],
                        max_length=30,
                        verbose_name="Action Type",
                    ),
                ),
                (
                    "action_name",
                    models.CharField(max_length=200, verbose_name="Action Name"),
                ),
                ("description", models.TextField(verbose_name="Description")),
                ("start_date", models.DateField(verbose_name="Start Date")),
                (
                    "target_date",
                    models.DateField(
                        blank=True, null=True, verbose_name="Target Completion Date"
                    ),
                ),
                (
                    "completion_date",
                    models.DateField(
                        blank=True, null=True, verbose_name="Actual Completion Date"
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("Planned", "Planned"),
                            ("In Progress", "In Progress"),
                            ("Completed", "Completed"),
                            ("Not Completed", "Not Completed"),
                        ],
                        default="Planned",
                        max_length=20,
                        verbose_name="Status",
                    ),
                ),
                (
                    "progress_notes",
                    models.TextField(blank=True, verbose_name="Progress Notes"),
                ),
                (
                    "teacher_notes",
                    models.TextField(blank=True, verbose_name="Teacher Notes"),
                ),
                (
                    "was_successful",
                    models.BooleanField(
                        blank=True, null=True, verbose_name="Was Successful"
                    ),
                ),
                (
                    "outcome_notes",
                    models.TextField(blank=True, verbose_name="Outcome Notes"),
                ),
                ("created_at", models.DateTimeField(auto_now_add=True)),
                ("updated_at", models.DateTimeField(auto_now=True)),
                (
                    "handled_by",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="handled_intervention_actions",
                        to="admin_functionalities.teacher",
                        verbose_name="Handled By",
                    ),
                ),
                (
                    "intervention_plan",
                    models.ForeignKey(
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="intervention_actions",
                        to="teacher.interventionplan",
                        verbose_name="Intervention Plan",
                    ),
                ),
            ],
            options={
                "verbose_name": "Intervention Action",
                "verbose_name_plural": "Intervention Actions",
                "ordering": ["-start_date", "-created_at"],
            },
        ),
        migrations.AddIndex(
            model_name="interventionplan",
            index=models.Index(
                fields=["student", "quarter", "school_year"],
                name="teacher_int_student_f96680_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="interventionplan",
            index=models.Index(
                fields=["risk_level", "is_active"],
                name="teacher_int_risk_le_70f934_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="interventionplan",
            index=models.Index(
                fields=["section", "subject"], name="teacher_int_section_989658_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="interventionaction",
            index=models.Index(
                fields=["intervention_plan", "status"],
                name="teacher_int_interve_84bd14_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="interventionaction",
            index=models.Index(
                fields=["tier", "action_type"], name="teacher_int_tier_aed7e2_idx"
            ),
        ),
    ]
